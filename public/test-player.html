<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player Test - ClickTerra AdServer</title>
    <link href="https://vjs.zencdn.net/8.5.2/video-js.css" rel="stylesheet" />
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        h1 {
            color: #333;
            text-align: center;
        }
        
        .player-container {
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .info h2 {
            margin-top: 0;
            color: #667eea;
        }
        
        .code {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>ðŸŽ¬ ClickTerra Video AdServer - Test Player</h1>
    
    <div class="info">
        <h2>Test Instructions</h2>
        <p>This page demonstrates VAST video ad integration. Before testing:</p>
        <ol>
            <li>Make sure the AdServer is running on port 3000</li>
            <li>Create at least one active campaign with a video creative</li>
            <li>Update the VAST URL below with your campaign ID</li>
        </ol>
    </div>
    
    <div class="player-container">
        <video
            id="my-player"
            class="video-js vjs-default-skin"
            controls
            preload="auto"
            width="640"
            height="360"
            data-setup='{}'>
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
        </video>
    </div>
    
    <div class="info">
        <h2>VAST Configuration</h2>
        <p>Current VAST URL:</p>
        <div class="code" id="vast-url-display">
            http://localhost:3000/vast?placement=test-player
        </div>
        
        <div class="note">
            <strong>Note:</strong> Make sure you have created campaigns and video creatives in the admin dashboard before testing.
            The video ad will play before the main content (pre-roll).
        </div>
    </div>
    
    <div class="info">
        <h2>What to Expect</h2>
        <ul>
            <li><strong>Ad Loading:</strong> A video ad should appear before the main video</li>
            <li><strong>Skip Button:</strong> After the configured skip offset, a skip button will appear</li>
            <li><strong>Tracking:</strong> All events (impression, quartiles, complete, click) are tracked automatically</li>
            <li><strong>Click Through:</strong> Clicking the ad will open the configured landing page</li>
        </ul>
    </div>
    
    <script src="https://vjs.zencdn.net/8.5.2/video.min.js"></script>
    <script>
        // Initialize Video.js player
        var player = videojs('my-player', {
            controls: true,
            autoplay: false,
            preload: 'auto'
        });
        
        // Note: For full VAST support with ads, you would need:
        // - videojs-contrib-ads plugin
        // - videojs-ima or videojs-vast-vpaid plugin
        // 
        // Example with IMA (Google's IMA SDK):
        // <script src="//imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
        // <script src="videojs-ima.js"></script>
        // 
        // player.ima({
        //   adTagUrl: 'http://localhost:3000/vast?placement=test-player'
        // });
        
        console.log('Video player initialized');
        console.log('To test ads, integrate with videojs-ima or similar VAST plugin');
        console.log('VAST URL:', 'http://localhost:3000/vast?placement=test-player');
        
        // Manual VAST testing
        async function testVAST() {
            try {
                const response = await fetch('http://localhost:3000/vast?placement=test-player');
                const vastXML = await response.text();
                console.log('VAST Response:', vastXML);
                return vastXML;
            } catch (error) {
                console.error('Error fetching VAST:', error);
            }
        }
        
        // You can call testVAST() in console to see the VAST XML
        window.testVAST = testVAST;
    </script>
</body>
</html>
